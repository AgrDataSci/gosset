<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Consumer preference of cassava gari-eba • gosset</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Consumer preference of cassava gari-eba">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gosset</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette-1-trait-prioritization-and-crop-performance.html">Integrating farmer-generated data and agro-climatic data for crop variety selection</a>
    </li>
    <li>
      <a href="../articles/vignette-2-gari-eba-consumer-testing.html">Consumer preference of cassava gari-eba</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/agrdatasci/gosset/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Consumer preference of cassava gari-eba</h1>
                        <h4 data-toc-skip class="author">Kauê de
Sousa</h4>
            <address class="author_afil">
      Digital Inclusion, Bioversity International, Montpellier, France
 Department of Agricultural Sciences, University of Inland Norway,
Hamar, Norway<br><small class="dont-index">Source: <a href="https://github.com/agrdatasci/gosset/blob/HEAD/vignettes/vignette-2-gari-eba-consumer-testing.Rmd" class="external-link"><code>vignettes/vignette-2-gari-eba-consumer-testing.Rmd</code></a></small>
      <div class="hidden name"><code>vignette-2-gari-eba-consumer-testing.Rmd</code></div>

    </address>
</div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates a workflow for analyzing consumer
preference data from decentralized trials of cassava (<em>Manihot
esculenta</em> Crantz) varieties in Nigeria and Cameroon. Using the
tricot approach <span class="citation">[1]</span>, 1,000 participants
evaluated gari-eba made from 13 cassava genotypes in 2022. The trial was
implemented by the International Institute of Tropical Agriculture
(IITA) under the RTBFoods project (<a href="https://rtbfoods.cirad.fr" class="external-link uri">https://rtbfoods.cirad.fr</a>). Participants assessed
overall preference and traits such as color, stretchability, and taste,
reflecting diverse consumer priorities.</p>
<p>Building on studies by Olaosebikan et al. (2023) <span class="citation">[2]</span> and Emmanuel Alamu et al. (2023) <span class="citation">[3]</span>, this vignette introduces an alternative
workflow. It leverages statistical models, such as the Plackett-Luce
model, to analyze overall preference, explore trait-specific
performance, and account for consumer heterogeneity. By segmenting the
data by groups like country, the analysis uncovers context-specific
varietal performance and identifies the best varieties for specific
groups.</p>
<p>Additionally, a weighted selection index is proposed to integrate
multiple traits, enabling a data-driven approach to ranking varieties.
This workflow emphasizes a consumer- and market-oriented approach,
offering insights into plant breeding and selection strategies that
align with local preferences and environmental contexts. <em>The
selection index approach is under development and open for improvements,
suggestions and comments</em>.</p>
</div>
<div class="section level2">
<h2 id="read-the-data-and-select-traits">Read the data and select traits<a class="anchor" aria-label="anchor" href="#read-the-data-and-select-traits"></a>
</h2>
<p>The <code>cassava</code> data is a data frame with 1,000 observations
and 27 variables, which are described in the data documentation with
<code><a href="../reference/cassava.html">?cassava</a></code>. This vignette will require the packages
PlackettLuce <span class="citation">[4]</span>, ClimMobTools <span class="citation">[5]</span>, ggplot2 <span class="citation">[6]</span>,
and patchwork <span class="citation">[7]</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://agrdatasci.github.io/gosset/" class="external-link">"gosset"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://agrdatasci.github.io/ClimMobTools/" class="external-link">"ClimMobTools"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://hturner.github.io/PlackettLuce/" class="external-link">"PlackettLuce"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com" class="external-link">"patchwork"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"cassava"</span>, package <span class="op">=</span> <span class="st">"gosset"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="va">cassava</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            id     option_a     option_b     option_c country gender age</span></span>
<span><span class="co">## 1   Osun-pkg1         TMS3 Game Changer         TMS6 Nigeria    Man  24</span></span>
<span><span class="co">## 2  Osun-pkg10         TMS1         TMS3   Obasanjo-2 Nigeria  Woman  29</span></span>
<span><span class="co">## 3 Osun-pkg100 Game Changer         Akpu         TMS2 Nigeria    Man  41</span></span>
<span><span class="co">## 4 Osun-pkg101         TMS6        TMEB2         TMS1 Nigeria  Woman  52</span></span>
<span><span class="co">## 5 Osun-pkg102        TMEB2         TMS2   Obasanjo-2 Nigeria  Woman  40</span></span>
<span><span class="co">## 6 Osun-pkg103   Obasanjo-2         Akpu Game Changer Nigeria  Woman  23</span></span>
<span><span class="co">##            consumption consumptionform colour_pos colour_neg</span></span>
<span><span class="co">## 1          once a week            &lt;NA&gt;          C          B</span></span>
<span><span class="co">## 2 several times a week            &lt;NA&gt;          A          C</span></span>
<span><span class="co">## 3 several times a week            &lt;NA&gt;          A          B</span></span>
<span><span class="co">## 4 several times a week            &lt;NA&gt;          A          C</span></span>
<span><span class="co">## 5 several times a week            &lt;NA&gt;          C          B</span></span>
<span><span class="co">## 6 several times a week            &lt;NA&gt;          A          B</span></span></code></pre>
<p>Here, we select the columns with complete cases to perform the
analysis. The remaining traits (tested in both studies) are color,
stretchability, taste, and overall preference.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">keep</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">keep</span> <span class="op">=</span> <span class="va">keep</span> <span class="op">==</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="va">dat</span><span class="op">[</span>, <span class="va">keep</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "id"                 "option_a"           "option_b"          </span></span>
<span><span class="co">##  [4] "option_c"           "country"            "gender"            </span></span>
<span><span class="co">##  [7] "age"                "consumption"        "colour_pos"        </span></span>
<span><span class="co">## [10] "colour_neg"         "stretchability_pos" "stretchability_neg"</span></span>
<span><span class="co">## [13] "taste_pos"          "taste_neg"          "overall_pos"       </span></span>
<span><span class="co">## [16] "overall_neg"</span></span></code></pre>
<p>The tricot data, in its original form, has a standard structure for
storing the ranking data in the form of two columns with the trait name
and the value for the best and the worst ranking (e.g., overall_pos,
overall_neg). The function <code><a href="https://agrdatasci.github.io/ClimMobTools/reference/getTraitList.html" class="external-link">getTraitList()</a></code> from the
<code>ClimMobTools</code> package runs through the columns in the data
to identify this structure and validates the rankings. The output is a
list with the identified rankings, their strings in the dataset, a
vector with the validated rankings, and the trait name. In the cassava
dataset, the pattern for the best and worst rankings is
<code>c("_pos", "_neg")</code>. We input this to the function
<code><a href="https://agrdatasci.github.io/ClimMobTools/reference/getTraitList.html" class="external-link">getTraitList()</a></code> using the argument
<code>pattern =</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract list of traits from the data</span></span>
<span><span class="va">trait_list</span> <span class="op">=</span> <span class="fu"><a href="https://agrdatasci.github.io/ClimMobTools/reference/getTraitList.html" class="external-link">getTraitList</a></span><span class="op">(</span><span class="va">dat</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_pos"</span>, <span class="st">"_neg"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># trait names extracted from the function </span></span>
<span><span class="va">traits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">trait_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">trait_label</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># clean trait names and put them title case</span></span>
<span><span class="va">traits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(^|[[:space:]])([[:alpha:]])"</span>, <span class="st">"\\1\\U\\2"</span>, <span class="va">traits</span>, perl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">traits</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Colour"         "Stretchability" "Taste"          "Overall"</span></span></code></pre>
<p>Here, we perform some data preparation by defining the column indices
for the variables with the cassava sample names, the names of varieties
tested in the study, and the position of “Overall” within the trait
list. We set Obasanjo-2 as the check variety.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pack</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"option_a"</span>, <span class="st">"option_b"</span>, <span class="st">"option_c"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">items</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span><span class="va">pack</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">check</span> <span class="op">=</span> <span class="st">"Obasanjo-2"</span></span>
<span></span>
<span><span class="va">ov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">traits</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Overall"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="assess-the-full-data">Assess the full data<a class="anchor" aria-label="anchor" href="#assess-the-full-data"></a>
</h2>
<p>The Plackett-Luce model <span class="citation">[4]</span> is used to
analyze the data. First, we transform the data into a PlackettLuce
object using the function <code><a href="../reference/rank_tricot.html">rank_tricot()</a></code>. We use
<code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> to apply the function to the list of traits.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">trait_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/rank_tricot.html">rank_tricot</a></span><span class="op">(</span><span class="va">dat</span>, </span>
<span>              items <span class="op">=</span> <span class="va">pack</span>, </span>
<span>              input <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">string</span>,</span>
<span>              validate.rankings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>To fit the model, we use the function <code><a href="https://hturner.github.io/PlackettLuce/reference/PlackettLuce.html" class="external-link">PlackettLuce()</a></code>
from the package ‘PlackettLuce’ <span class="citation">[4]</span>, also
using <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code>. This returns a list of models, one per
trait. First, we focus on the overall preference. We use the function
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> to visualize the Plackett-Luce estimates as
<em>log-worth</em> parameters using the argument
<code>log = TRUE</code>. The argument <code>levels =</code> establishes
the order of the varieties in the plot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">R</span>, <span class="va">PlackettLuce</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">[[</span><span class="va">ov</span><span class="op">]</span><span class="op">]</span>,</span>
<span>     ref <span class="op">=</span> <span class="va">check</span>,</span>
<span>     log <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">items</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette-2-gari-eba-consumer-testing_files/figure-html/plfit-1.png" width="700"></p>
<p>The plot shows that the varieties TMS6, Sape and TMEB1 outperform
Obasanjo-2 for overall preference. We use the function
<code><a href="../reference/reliability.html">reliability()</a></code> to identify the improvement achieved by these
varieties against reference Obasanjo-2 <span class="citation">[8]</span>. The function returns a data frame with the
reliability estimates, where values above 0.5 indicates that the variety
outperforms the reference. We plot these results using
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rel</span> <span class="op">=</span> <span class="fu"><a href="../reference/reliability.html">reliability</a></span><span class="op">(</span><span class="va">mod</span><span class="op">[[</span><span class="va">ov</span><span class="op">]</span><span class="op">]</span>, ref <span class="op">=</span> <span class="va">check</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel</span><span class="op">$</span><span class="va">improvement</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">rel</span><span class="op">$</span><span class="va">reliability</span> <span class="op">/</span> <span class="fl">0.5</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rel</span> <span class="op">=</span> <span class="va">rel</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">rel</span><span class="op">$</span><span class="va">improvement</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">rel</span><span class="op">$</span><span class="va">item</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">rel</span><span class="op">$</span><span class="va">item</span>, levels <span class="op">=</span> <span class="va">rel</span><span class="op">$</span><span class="va">item</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rel</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">improvement</span>, </span>
<span>           y <span class="op">=</span> <span class="va">item</span>,</span>
<span>           fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>           width <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>           position <span class="op">=</span> <span class="st">"dodge"</span>, </span>
<span>           show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"#5aae61"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"grey40"</span>,</span>
<span>             linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability of outperforming the check"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette-2-gari-eba-consumer-testing_files/figure-html/reliability-1.png" width="700"></p>
<p>The reliability estimates show an improvement in overall preference
of 32% for TMS6, 18% for Sape and 8% for TMEB1.</p>
<p>So far, we have focused solely on the overall preference. However,
there are other traits to assess. The function <code>worth_plot()</code>
can be used to visually analyze and compare variety performance across
different traits. The values represented in a worth map are
<em>log-worth</em> estimates. The function can be used with
<code>ggplot2</code> functions to improve the plot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/worth_map.html">worth_map</a></span><span class="op">(</span><span class="va">mod</span>, </span>
<span>          labels <span class="op">=</span> <span class="va">traits</span>, </span>
<span>          labels.order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Overall"</span>, <span class="st">"Taste"</span>, <span class="st">"Stretchability"</span>, <span class="st">"Colour"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette-2-gari-eba-consumer-testing_files/figure-html/worth-1.png" width="700"></p>
<p>The worth map confirms the superiority of TMS6, Sape and TMEB1 across
the traits, but also presents Madame among the top varieties for color.
We will return to this analysis later, but for now, let us examine the
data from the perspective of different groups to consider heterogeneity
in the participants’ evaluations, as proposed by van Etten et al. (2023)
<span class="citation">[9]</span>.</p>
</div>
<div class="section level2">
<h2 id="participants-heterogeneity">Participants’ heterogeneity<a class="anchor" aria-label="anchor" href="#participants-heterogeneity"></a>
</h2>
<p>We will focus on two covariates to analyze the data: gender and
country. The function <code><a href="../reference/likelihood_ratio.html">likelihood_ratio()</a></code> is used to test
which of these covariates can provide distinguishable rankings within
the groups.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># by gender</span></span>
<span><span class="va">llr1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">R</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/likelihood_ratio.html">likelihood_ratio</a></span><span class="op">(</span><span class="va">x</span>, split <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">llr1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">llr1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">llr1</span><span class="op">$</span><span class="va">trait</span> <span class="op">=</span> <span class="va">traits</span></span>
<span></span>
<span><span class="va">llr1</span></span></code></pre></div>
<pre><code><span><span class="co">##    deviance DF_delta Pr(&gt;Chisq)                trait</span></span>
<span><span class="co">##       &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;</span></span>
<span><span class="co">## 1:  11.7619  12.0000     0.4650               Colour</span></span>
<span><span class="co">## 2:   9.8536  12.0000     0.6288       Stretchability</span></span>
<span><span class="co">## 3:   7.4512  12.0000     0.8264                Taste</span></span>
<span><span class="co">## 4:   8.6690  12.0000     0.7309              Overall</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># by country</span></span>
<span><span class="va">llr2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">R</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/likelihood_ratio.html">likelihood_ratio</a></span><span class="op">(</span><span class="va">x</span>, split <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">country</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">llr2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">llr2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">llr2</span><span class="op">$</span><span class="va">trait</span> <span class="op">=</span> <span class="va">traits</span></span>
<span></span>
<span><span class="va">llr2</span> </span></code></pre></div>
<pre><code><span><span class="co">##    deviance DF_delta Pr(&gt;Chisq)                trait</span></span>
<span><span class="co">##       &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;</span></span>
<span><span class="co">## 1:  69.3164  12.0000     0.0000   ***         Colour</span></span>
<span><span class="co">## 2:  24.8679  12.0000     0.0155     * Stretchability</span></span>
<span><span class="co">## 3:  26.9415  12.0000     0.0079    **          Taste</span></span>
<span><span class="co">## 4:  38.2459  12.0000     0.0001   ***        Overall</span></span></code></pre>
<p>The likelihood-ratio test indicates that sub-setting the data by
country provides statistically different rankings. This test can also be
used to validate more complex groupings, such as those generated by
cluster analysis or farmers’ typologies, which include a diverse set of
variables (e.g., socio-economic and agroecological), as proposed by Voss
et al. (2024) <span class="citation">[10]</span>. For simplicity, we
focus here only on the variable “country.”</p>
<p>Now, returning to the worth map analysis, we can visualize the
performance of the varieties within the groups. We iterate over the
groups by sub-setting the data in a loop. Within the loop, we create the
plots and store them in a list. Finally, we use the
<code>patchwork</code> package to display the two worth maps.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the slice variable as a vector</span></span>
<span><span class="va">slice</span> <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">country</span></span>
<span></span>
<span><span class="co"># and get the unique values</span></span>
<span><span class="va">slice_lvs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">slice</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trait_plot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># order of varieties from best to worst in the full dataset</span></span>
<span><span class="va">items_lvls</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rank.html" class="external-link">rank</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod</span><span class="op">[[</span><span class="va">ov</span><span class="op">]</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">*</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">slice_lvs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># fit the model also applying the slice</span></span>
<span>  <span class="va">mod_i</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">R</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://hturner.github.io/PlackettLuce/reference/PlackettLuce.html" class="external-link">PlackettLuce</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">slice</span> <span class="op">==</span> <span class="va">slice_lvs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># plot the worth map</span></span>
<span>  <span class="va">trait_plot</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/worth_map.html">worth_map</a></span><span class="op">(</span><span class="va">mod_i</span>,</span>
<span>                              labels <span class="op">=</span> <span class="va">traits</span>,</span>
<span>                              labels.order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Overall"</span>, <span class="st">"Taste"</span>, <span class="st">"Stretchability"</span>, <span class="st">"Colour"</span><span class="op">)</span>,</span>
<span>                              items.order <span class="op">=</span> <span class="va">items_lvls</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># plot the two maps using patchwork</span></span>
<span><span class="va">trait_plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">trait_plot</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette-2-gari-eba-consumer-testing_files/figure-html/worth2-1.png" width="700"></p>
<p>The segmented analysis reveals contrasting results compared to the
previous analysis using the full dataset. It highlights the superiority
of TMS6 and TMEB1 in Nigeria, and Game Changer and Sape in Cameroon.
This approach provides a visual method to select the best variety
overall for each group.</p>
</div>
<div class="section level2">
<h2 id="selection-index">Selection index<a class="anchor" aria-label="anchor" href="#selection-index"></a>
</h2>
<p>To account for all traits in a data-driven manner when selecting
varieties, I propose a selection index approach. This method calculates
weighted estimates and derives a selection score that represents the
overall performance of the varieties across all traits.</p>
<p>Suppose we have three varieties with standardized probabilities for
each trait:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="23%">
<col width="19%">
<col width="20%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Variety</th>
<th>Yield (0.5)</th>
<th>Marketability (0.3)</th>
<th>Tolerance to drought (0.2)</th>
<th>Selection Index Score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Variety 1</td>
<td>0.8</td>
<td>0.6</td>
<td>0.7</td>
<td>(0.8<em>0.5) + (0.6</em>0.3) + (0.7*0.2) =
<strong>0.71</strong>
</td>
</tr>
<tr class="even">
<td>Variety 2</td>
<td>0.7</td>
<td>0.8</td>
<td>0.5</td>
<td>(0.7<em>0.5) + (0.8</em>0.3) + (0.5*0.2) =
<strong>0.68</strong>
</td>
</tr>
<tr class="odd">
<td>Variety 3</td>
<td>0.6</td>
<td>0.7</td>
<td>0.9</td>
<td>(0.6<em>0.5) + (0.7</em>0.3) + (0.9*0.2) =
<strong>0.70</strong>
</td>
</tr>
</tbody>
</table>
<p>Here, <em>Variety 1</em> would have the highest selection index
score, making it a top choice based on this weighted approach.</p>
<p>For this example, we will use the Kendall’s Tau correlation
coefficient <span class="citation">[11]</span>, estimated with the
function <code><a href="../reference/kendallTau.html">kendallTau()</a></code>. We began by calculating Kendall’s
Tau correlation coefficients
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>)
for each trait against the overall preference. This non-parametric
statistic measures the strength and direction of association between two
ranked variables, making it robust to outliers and suitable for ordinal
data. The goal is to identify how strongly each trait aligns with
farmers’ overall preference rankings. We also include the overall
preference in the kendall tau estimation as this trait will also be part
of the selection index.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kendall</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">R</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/kendallTau.html">kendallTau</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">R</span><span class="op">[[</span><span class="va">ov</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kendall</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">kendall</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kendall</span><span class="op">$</span><span class="va">trait</span> <span class="op">=</span> <span class="va">traits</span></span>
<span></span>
<span><span class="va">kendall</span></span></code></pre></div>
<pre><code><span><span class="co">##    kendallTau N_effective  Zvalue Pr(&gt;|z|)          trait</span></span>
<span><span class="co">##         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;          &lt;chr&gt;</span></span>
<span><span class="co">## 1:     0.4260     77.9355  5.5164   0.0000         Colour</span></span>
<span><span class="co">## 2:     0.3255     77.8579  4.2138   0.0000 Stretchability</span></span>
<span><span class="co">## 3:     0.6180     77.9613  8.0050   0.0000          Taste</span></span>
<span><span class="co">## 4:     1.0000     77.9613 12.9531   0.0000        Overall</span></span></code></pre>
<p>Using the Kendall
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>)
estimates, we derive weights for each trait. These weights represent the
contribution of each trait to the selection. To ensure comparability and
sum-to-1 constraints, the weights are normalized. The overall preference
score had the highest weight due to its perfect Kendall
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
= 1.0). While this aligns with intuition, it risks biasing the selection
index by disproportionately favoring varieties that score well on
“Overall” alone. To address this we apply a penalty specifically to the
“Overall” weight to reduce its influence without discarding its
importance. We used a logarithmic penalty for “Overall”, as it reduces
large values more significantly while maintaining relative differences.
After penalizing “Overall” all weights are re-normalized to ensure the
sum of weights = 1.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kendall</span><span class="op">$</span><span class="va">weights</span> <span class="op">=</span> <span class="va">kendall</span><span class="op">$</span><span class="va">kendallTau</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">kendall</span><span class="op">$</span><span class="va">kendallTau</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># identify the "Overall" trait and apply the penalty</span></span>
<span><span class="va">kendall</span><span class="op">$</span><span class="va">weights</span><span class="op">[</span><span class="va">ov</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">kendall</span><span class="op">$</span><span class="va">weights</span><span class="op">[</span><span class="va">ov</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># re-normalize weights to ensure they sum to 1</span></span>
<span><span class="va">kendall</span><span class="op">$</span><span class="va">weights</span> <span class="op">=</span> <span class="va">kendall</span><span class="op">$</span><span class="va">weights</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">kendall</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kendall</span></span></code></pre></div>
<pre><code><span><span class="co">##    kendallTau N_effective  Zvalue Pr(&gt;|z|)          trait weights</span></span>
<span><span class="co">##         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;          &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">## 1:     0.4260     77.9355  5.5164   0.0000         Colour  0.1933</span></span>
<span><span class="co">## 2:     0.3255     77.8579  4.2138   0.0000 Stretchability  0.1477</span></span>
<span><span class="co">## 3:     0.6180     77.9613  8.0050   0.0000          Taste  0.2804</span></span>
<span><span class="co">## 4:     1.0000     77.9613 12.9531   0.0000        Overall  0.3786</span></span></code></pre>
<p>After applying the penalty and re-normalizing, the influence of
“Overall” was reduced, and its weight was redistributed proportionally
to other traits. The adjusted weights are now ready for inclusion in the
selection index to rank cassava varieties. The overarching goal is to
have a global selection index that reflects the preferences of the
entire population in the dataset. If the groups have distinct
preferences or represent different environments, calculating weights
separately for each group ensures that the index reflects their unique
priorities. Here we assume that the relationships between traits and the
“Overall” are consistent across groups.</p>
<p>We iterate over the groups in a loop, storing the model coefficients
in a data frame for visualization with <code>ggplot</code>. The
selection index is computed as:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weights</span> <span class="op">=</span> <span class="va">kendall</span><span class="op">$</span><span class="va">weights</span></span>
<span></span>
<span><span class="va">select</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">slice_lvs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># fit the model</span></span>
<span>  <span class="va">mod_i</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">R</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://hturner.github.io/PlackettLuce/reference/PlackettLuce.html" class="external-link">PlackettLuce</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">slice</span> <span class="op">==</span> <span class="va">slice_lvs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># extract the coefficients</span></span>
<span>  <span class="va">coeffs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mod_i</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="va">x</span>, log <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">coeffs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">coeffs</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># apply the weights within the coefficients</span></span>
<span>  <span class="va">coeffs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">coeffs</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">*</span> <span class="va">weights</span><span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">coeffs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">coeffs</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># put it in a data.frame</span></span>
<span>  <span class="va">select_i</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coeffs</span><span class="op">)</span>,</span>
<span>                        slice <span class="op">=</span> <span class="va">slice_lvs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span>
<span>                        score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">coeffs</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">select</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">select</span>, <span class="va">select_i</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">select</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span>, </span>
<span>           y <span class="op">=</span> <span class="va">item</span>,</span>
<span>           fill <span class="op">=</span> <span class="va">slice</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>           width <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>           position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#d73027"</span>, <span class="st">"#4575b4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">select</span><span class="op">$</span><span class="va">score</span><span class="op">)</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"grey40"</span>,</span>
<span>             linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Selection score"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette-2-gari-eba-consumer-testing_files/figure-html/selection-1.png" width="700"></p>
<p>The selection score indicates that the superior varieties for Nigeria
are TMS6, TMEB1, TMS3, and Obasanjo-2, while for Cameroon, the varieties
Game Changer, Sape, and Madame exhibit superior performance, exceeding
the average as indicated by the grey vertical line. This approach
contrasts with the previous analysis based solely on overall preference
and the visualization provided by the worth map. By accounting for the
heterogeneity of consumer preferences, it facilitates the identification
of the best varieties for specific groups and market segments.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette demonstrates a workflow for analyzing consumer
preference trial data using the tricot approach. By integrating
innovative visualization techniques, we explored the performance of
cassava varieties across multiple traits and participant groups in
Nigeria and Cameroon. The analysis highlights the utility of worth maps
and selection scores in identifying superior varieties for specific
contexts.</p>
<p>In this study, we identified TMS6, TMEB1, TMS3, and Obasanjo-2 as
top-performing varieties in Nigeria, while Game Changer, Sape, and
Madame stood out in Cameroon. The selection index approach further
enabled the integration of weighted estimates for traits such as color,
stretchability, taste, and overall preference, providing a holistic
evaluation of variety performance. This flexible approach allows for
customization of weights to align with different stakeholder priorities
or objectives.</p>
<p>Additionally, the application of subgroup analysis, using country as
a covariate, demonstrated the potential to uncover heterogeneity in
preferences and tailor variety recommendations. This method could be
extended to more complex groupings, such as those based on cluster
analyses or farmer typologies incorporating socio-economic and
agroecological variables.</p>
<p>Overall, this vignette underscores the value of combining
participatory approaches, advanced statistical models, and visualization
tools for robust variety selection. By applying these methods,
researchers and practitioners can make informed decisions to improve
crop variety adoption and enhance food systems in diverse agricultural
contexts.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" entry-spacing="0">
<div id="ref-deSousa2024" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">de
Sousa, K.; van Etten, J.; Manners, R.; Abidin, E.; Abdulmalik, R.O.;
Abolore, B.; Acheremu, K.; Angudubo, S.; Aguilar, A.; Arnaud, E.; et al.
The <span class="nocase">tricot</span> Approach: An Agile Framework for
Decentralized on-Farm Testing Supported by Citizen Science. A
Retrospective. <em>Agronomy for Sustainable Development</em>
<strong>2024</strong>, <em>44</em>, doi:<a href="https://doi.org/10.1007/s13593-023-00937-1" class="external-link">10.1007/s13593-023-00937-1</a>.</div>
</div>
<div id="ref-Olaosebikan2023" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Olaosebikan, O.; Bello, A.; de Sousa, K.;
Ndjouenkeu, R.; Adesokan, M.; Alamu, E.; Agbona, A.; van Etten, J.;
Kégah, F.N.; Dufour, D.; et al. Drivers of Consumer Acceptability of
Cassava Gari‐eba Food Products Across Cultural and Environmental
Settings Using the Triadic Comparison of Technologies Approach (Tricot).
<em>Journal of the Science of Food and Agriculture</em>
<strong>2023</strong>, <em>104</em>, 4770–4781, doi:<a href="https://doi.org/10.1002/jsfa.12867" class="external-link">10.1002/jsfa.12867</a>.</div>
</div>
<div id="ref-EmmanuelAlamu2023" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Emmanuel Alamu, O.; Teeken, B.; Ayetigbo, O.;
Adesokan, M.; Kayondo, I.; Chijioke, U.; Madu, T.; Okoye, B.; Abolore,
B.; Njoku, D.; et al. Establishing the Linkage Between Eba’s
Instrumental and Sensory Descriptive Profiles and Their Correlation with
Consumer Preferences: Implications for Cassava Breeding. <em>Journal of
the Science of Food and Agriculture</em> <strong>2023</strong>,
<em>104</em>, 4573–4585, doi:<a href="https://doi.org/10.1002/jsfa.12518" class="external-link">10.1002/jsfa.12518</a>.</div>
</div>
<div id="ref-Turner2020" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">Turner, H.L.; van Etten, J.; Firth, D.;
Kosmidis, I. <span class="nocase">Modelling rankings in R: the
PlackettLuce package</span>. <em>Computational Statistics</em>
<strong>2020</strong>, doi:<a href="https://doi.org/10.1007/s00180-020-00959-3" class="external-link">10.1007/s00180-020-00959-3</a>.</div>
</div>
<div id="ref-ClimMobTools" class="csl-entry">
<div class="csl-left-margin">5. </div>
<div class="csl-right-inline">de
Sousa, K.; van Etten, J.; Madriz, B. <a href="https://doi.org/10.32614/cran.package.climmobtools" class="external-link"><span class="nocase">ClimMobTools: API Client for the <span>“ClimMob”</span>
Platform</span></a>. <em>CRAN: Contributed Packages</em> 2019.</div>
</div>
<div id="ref-ggplot2" class="csl-entry">
<div class="csl-left-margin">6. </div>
<div class="csl-right-inline">Wickham, H. <em><a href="https://ggplot2.tidyverse.org" class="external-link"><span class="nocase">ggplot2</span>: Elegant Graphics for Data
Analysis</a></em>; Springer-Verlag New York, 2016; ISBN
978-3-319-24277-4.</div>
</div>
<div id="ref-patchwork" class="csl-entry">
<div class="csl-left-margin">7. </div>
<div class="csl-right-inline">Pedersen, T.L. <a href="https://doi.org/10.32614/cran.package.patchwork" class="external-link"><span class="nocase">patchwork: The Composer of Plots</span></a>. <em>CRAN:
Contributed Packages</em> 2019.</div>
</div>
<div id="ref-eskridge_1992" class="csl-entry">
<div class="csl-left-margin">8. </div>
<div class="csl-right-inline">Eskridge, K.M.; Mumm, R.F. Choosing Plant
Cultivars Based on the Probability of Outperforming a Check.
<em>Theoretical and Applied Genetics</em> <strong>1992</strong>,
<em>84</em>, 494–500, doi:<a href="https://doi.org/10.1007/BF00229512" class="external-link">10.1007/BF00229512</a>.</div>
</div>
<div id="ref-vanEtten2023" class="csl-entry">
<div class="csl-left-margin">9. </div>
<div class="csl-right-inline">van
Etten, J.; de Sousa, K.; Cairns, J.E.; Dell’Acqua, M.; Fadda, C.;
Guereña, D.; van Heerwaarden, J.; Assefa, T.; Manners, R.; Müller, A.;
et al. Data-Driven Approaches Can Harness Crop Diversity to Address
Heterogeneous Needs for Breeding Products. <em>Proceedings of the
National Academy of Sciences</em> <strong>2023</strong>, <em>120</em>,
doi:<a href="https://doi.org/10.1073/pnas.2205771120" class="external-link">10.1073/pnas.2205771120</a>.</div>
</div>
<div id="ref-Voss2024" class="csl-entry">
<div class="csl-left-margin">10. </div>
<div class="csl-right-inline">Voss, R.C.; de Sousa, K.; N’Danikou, S.;
Shango, A.; Aglinglo, L.A.; Laporte, M.-A.; Legba, E.C.; Houdegbe, A.C.;
Diarra, D. dit Y.; Dolo, A.; et al. Citizen Science Informs
Demand-Driven Breeding of Opportunity Crops. <strong>2024</strong>,
doi:<a href="https://doi.org/10.1101/2024.07.31.605211" class="external-link">10.1101/2024.07.31.605211</a>.</div>
</div>
<div id="ref-Kendall_1939" class="csl-entry">
<div class="csl-left-margin">11. </div>
<div class="csl-right-inline">Kendall, M.G.; Smith, B.B. The Problem of m
Rankings. <em>The Annals of Mathematical Statistics</em>
<strong>1939</strong>, <em>10</em>, 275–287.</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kauê de Sousa, Jacob van Etten, David Brown, Jonathan Steinke, Joost van Heerwaarden.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
